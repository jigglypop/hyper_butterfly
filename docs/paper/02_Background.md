## 2. 이론적 배경: 왜 기하학인가?

`Reality Stone`의 핵심 방법론인 리만 기하학 기저 인코딩(RBE)을 이해하기 위해서는, 먼저 "왜 딥러닝에서 유클리드 기하학을 넘어서는 새로운 기하학이 필요한가?"라는 근본적인 질문에 답해야 한다. 본 장에서는 그 필요성에서 출발하여 RBE의 이론적 토대가 되는 핵심 수학 개념들을 비전문가도 이해할 수 있도록 단계적으로 설명한다.

### 2.1. 평평한 세계의 한계: 유클리드 기하학

우리가 일상적으로 사용하는 기하학은 **유클리드 기하학(Euclidean Geometry)**이다. 두 점 사이의 최단 거리는 직선이고, 삼각형 내각의 합은 항상 180도인, 우리가 사는 공간에 대한 직관적인 모델이다. 대부분의 딥러NING 모델 역시 가중치와 데이터를 이 유클리드 공간에 존재하는 벡터와 행렬로 가정한다.

하지만 현실 세계의 데이터는 항상 이렇게 '평평'하지 않다.
- **계층 구조 데이터:** 생물의 분류 체계(종-속-과-목), 언어의 통사 구조(단어-구-절), 거대 조직의 구성도 등은 모두 나무와 같은 **계층 구조**를 가진다. 이를 평평한 2차원 평면에 억지로 구겨 넣으려면, 부모-자식 관계가 왜곡되거나 서로 무관한 노드들이 가깝게 배치되는 문제가 발생한다.
- **순환 구조 데이터:** 소셜 네트워크나 분자 구조처럼 순환(cycle)과 상호 연결이 중요한 데이터 역시 유클리드 공간에서는 그 관계성을 효율적으로 표현하기 어렵다.

이러한 데이터를 유클리드 공간에 임베딩하는 것은, 둥근 지구를 평평한 세계 지도에 그리는 것과 같다. 어떻게 그리든 필연적으로 남극 대륙이 거대하게 왜곡되는 것처럼, 데이터의 본질적인 구조가 손실될 수밖에 없다.

### 2.2. 휘어진 세계로의 확장: 리만 다양체

이 문제를 해결하기 위해 수학자들은 **리만 다양체(Riemannian Manifold)** 라는 개념을 도입했다.

- **다양체(Manifold)란 무엇인가?**
  쉽게 비유하자면, 지구 표면과 같다. 지구 표면은 분명히 둥글게 휘어져 있지만, 우리가 발을 딛고 있는 아주 좁은 영역(동네, 도시)만 보면 거의 평평한 2차원 평면처럼 보인다. 이처럼 **전체적으로는 휘어져 있지만, 국소적으로(아주 가까이서 보면) 유클리드 공간과 유사한 공간**을 다양체라고 부른다.

- **리만 기하학(Riemannian Geometry)이란?**
  이러한 휘어진 다양체 위에서 기하학을 하는 방법이다. 리만 기하학은 각 지점의 '휘어진 정도'를 측정하는 **리만 계량(Riemannian Metric)** 이라는 도구를 도입한다. 이 계량을 통해 우리는 휘어진 공간 위에서도 두 점 사이의 최단 거리(측지선, Geodesic), 벡터의 길이, 벡터 사이의 각도 등을 일관되게 계산할 수 있다.

### 2.3. RBE를 위한 새로운 공간: 쌍곡 기하학

리만 기하학의 수많은 갈래 중, RBE와 특히 밀접한 관련이 있는 것은 **쌍곡 기하학(Hyperbolic Geometry)** 이다.

쌍곡 공간은 모든 지점에서 음(-)의 상수 곡률을 갖는 공간이다. 이는 유클리드 공간(곡률 0)이나 구면(양의 곡률)과는 매우 다른, 독특한 특성을 낳는다. 가장 중요한 특징은 **공간의 부피가 반지름에 따라 지수적으로 증가한다**는 것이다.

- **직관적 비유:** 평평한 유클리드 원의 둘레는 반지름 $r$에 비례($2\pi r$)하지만, 쌍곡 원반의 둘레는 반지름 $r$에 대해 지수적으로($e^r$) 늘어난다. 이는 마치 프링글스 감자칩 표면처럼, 바깥으로 나아갈수록 공간이 훨씬 더 빠르게 넓어지는 것과 같다.

이러한 특성은 앞서 언급한 **계층 구조 데이터를 표현하는 데 이상적**이다. 트리 구조의 깊이가 한 단계 깊어질 때마다 노드의 수가 지수적으로 증가하는 경향이, 쌍곡 공간의 부피가 지수적으로 팽창하는 특성과 정확히 일치하기 때문이다. 따라서 쌍곡 공간은 계층적 데이터를 훨씬 낮은 차원에서, 정보의 왜곡을 최소화하며 임베딩할 수 있는 '최적의 그릇'을 제공한다.

`Reality Stone`은 다음과 같은 여러 쌍곡 기하학 모델을 지원하며, RBE는 이 모델들의 기저(basis)를 활용한다.

1.  **푸앵카레 원반 모델 (Poincaré Ball Model):**
    -   **개념:** 유한한 크기의 원반 안에 무한한 쌍곡 공간을 표현한 모델. 원반의 중심으로 갈수록 유클리드 공간과 비슷해지고, 경계로 갈수록 공간이 극도로 왜곡되며 넓어진다.
    -   **특징:** 각도를 그대로 보존(등각, Conformal)하기 때문에, 변환의 형태를 시각적으로 이해하기 좋아 딥러닝에서 널리 사용된다.

2.  **로렌츠 모델 (Lorentz Model):**
    -   **개념:** 한 차원 높은 민코프스키 시공간(Minkowski spacetime) 내의 쌍곡면으로 공간을 정의한다.
    -   **특징:** 기하학적 연산들이 행렬 곱셈 등 선형 대수로 간단하게 표현되어, 수치적으로 안정적이고 계산이 빠르다는 장점이 있다.

### 2.4. 기하학적 공간에서의 연산: 어떻게 계산할 것인가?

쌍곡 공간과 같은 휘어진 공간에서는 유클리드 공간의 덧셈($a+b$)이나 스칼라 곱셈($c \cdot a$)이 더 이상 통하지 않는다. 직선으로 더했다가는 공간 밖으로 튕겨 나갈 수 있기 때문이다.

이를 해결하기 위해 **자이로벡터 공간(Gyrovector Space)** 이론이 도입되었다. 이는 쌍곡 공간의 특성을 반영한 새로운 대수적 구조를 제공한다.

-   **뫼비우스 덧셈 ($\oplus$) 및 스칼라 곱셈 ($\otimes$):** 유클리드 덧셈과 스칼라 곱셈을 대체하는 연산. 이 연산들은 결과가 항상 공간 안에 머무르도록 보장한다.
-   **지수/로그 사상 (Exponential/Logarithmic Maps):**
    -   **로그 사상 ($\log_p(q)$):** 다양체 위의 두 점 $p, q$를, 기준점 $p$에서의 '평평한' 접공간(tangent space)에 있는 벡터로 변환한다. 이는 $q$로 가기 위해 $p$에서 어떤 방향과 속도로 출발해야 하는지를 알려준다.
    -   **지수 사상 ($\exp_p(v)$):** 기준점 $p$의 접공간에 있는 벡터 $v$를 다시 다양체 위의 점으로 되돌려 놓는다. $p$에서 $v$의 방향과 속도로 '직진'했을 때 도착하는 지점이다.

신경망의 선형 변환($Wx+b$)은 주로 접공간에서 이루어지며, 그 결과를 지수 사상을 통해 다시 다양체 위로 올리고, 비선형 활성화 함수를 적용하는 과정이 반복된다. **RBE는 바로 이 접공간에서의 변환, 즉 행렬 $W$를 기저 함수로 분해하는 기술이다.** 
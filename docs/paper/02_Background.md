## 2. 수학적 배경: 휘어진 공간으로의 초대

본 장에서는 `Reality Stone`의 이론적 토대를 이루는 리만 기하학(Riemannian Geometry)과 쌍곡 기하학의 핵심 개념들을 소개한다. 독자가 수학 전공자가 아니라는 가정하에, 가능한 한 직관적인 비유와 예시를 통해 개념을 설명하고자 한다.

### 2.1 리만 다양체: 우리 발밑의 지구처럼

리만 다양체는 유클리드 공간을 일반화한 개념으로, **"국소적으로는 평평하지만, 전체적으로는 휘어져 있을 수 있는 공간"**을 수학적으로 다루는 틀이다. 가장 좋은 예시는 우리가 사는 '지구'이다.

-   **매끄러운 다양체(Smooth Manifold)**: 우리 발밑의 땅은 평평해 보이지만, 우주에서 보면 지구는 둥근 공 모양이다. 이처럼, 모든 점의 아주 작은 근방(neighborhood)은 유클리드 공간($\mathbb{R}^n$)처럼 취급할 수 있는 공간을 다양체라고 한다. 우리가 지구 곳곳에 평면 지도를 그릴 수 있는 이유가 바로 지구가 다양체이기 때문이다.

-   **접공간(Tangent Space)**: 지구 위의 한 점(예: 서울)에 서서, 그 지점을 기준으로 동서남북으로 뻗어 나가는 가상의 평면을 상상해보자. 이 평면이 바로 서울 지점에서의 '접공간' $T_pM$이다. 이는 휘어진 다양체 위의 한 점에서 '움직임'(속도, 방향)을 정의하기 위해 도입된 국소적인 유클리드 공간(벡터 공간)이다.

-   **리만 계량(Riemannian Metric)**: 지구 적도에서의 1km와 북극 근처에서의 1km는 지도(메르카토르 도법) 상에서 다르게 표현된다. 리만 계량 $g$는 이처럼 **공간의 각 지점마다 거리와 각도를 재는 '자(ruler)'가 어떻게 변하는지**를 정의한다. 이 '국소적인 자' 덕분에 우리는 휘어진 공간 전체에서 곡선의 길이나 면적을 계산할 수 있게 된다. $g_{ij}(x) = \langle \frac{\partial}{\partial x^i}, \frac{\partial}{\partial x^j} \rangle_p$는 특정 좌표계에서 이 '자'가 어떻게 생겼는지를 행렬로 표현한 것이다.

-   **측지선(Geodesic)**: 서울에서 뉴욕까지 가는 가장 빠른 항로는 지도에 직선을 그은 것이 아니라, 지구 중심을 향해 살짝 파고드는 곡선(대권 항로)이다. 이처럼, 리만 다양체 위에서 두 점을 잇는 '가장 곧은' 경로, 즉 최단 거리를 나타내는 곡선을 측지선이라고 한다. 이는 유클리드 공간의 '직선' 개념을 일반화한 것이다.

-   **곡률(Curvature)**: 다양체가 얼마나 휘어져 있는지를 나타내는 척도이다. 곡률이 양수(+)이면 지구 표면처럼 닫힌 공간의 특성을, 음수(-)이면 안장처럼 열린 공간의 특성을, 0이면 평평한 유클리드 공간의 특성을 가진다. 쌍곡 기하학은 바로 이 '음의 곡률'을 가진 공간을 탐구하는 학문이다.

### 2.2 쌍곡 기하학 모델: 계층 구조를 담는 그릇

음의 상수 곡률을 갖는 쌍곡 공간($\mathbb{H}^n$)은 본질적으로 하나이지만, 그것을 시각화하고 계산하기 위한 여러 '지도' 또는 모델이 존재한다.

1.  **푸앵카레 원반 모델 (Poincaré Ball Model)**:
    -   **개념**: 마치 **어안 렌즈로 세상을 들여다보는 것**과 같다. 이 모델은 유한한 크기의 원반($\mathbb{B}^n = \{ \mathbf{x} \in \mathbb{R}^n : \|\mathbf{x}\| < 1 \}$) 안에 무한한 쌍곡 공간 전체를 표현한다.
    -   **특징**: 중심에 가까울수록 대상이 크게 보이고, 원반의 경계에 가까워질수록 극도로 작아져 결코 경계에 닿을 수 없다. 이 '공간 왜곡'은 리만 계량 $g_x = \left(\frac{2}{1-\|\mathbf{x}\|^2}\right)^2 g_E$ 로 표현된다. 경계로 갈수록($\|\mathbf{x}\| \to 1$) 분모가 0에 가까워지므로, 유클리드 거리상 짧은 한 걸음이 실제 쌍곡 공간에서는 엄청나게 긴 거리가 된다.
    -   **거리**: 두 점 $\mathbf{u}, \mathbf{v}$ 사이의 거리는 다음 공식으로 계산된다. 이 공식은 두 점 사이의 유클리드 거리 $\|\mathbf{u} - \mathbf{v}\|^2$를 각 점의 위치에 따른 '공간의 휘어짐' $(1 - \|\mathbf{u}\|^2), (1 - \|\mathbf{v}\|^2)$으로 보정한 값에 기반한다.
        $$
        d(\mathbf{u}, \mathbf{v}) = \cosh^{-1} \left( 1 + 2 \frac{\|\mathbf{u} - \mathbf{v}\|^2}{(1 - \|\mathbf{u}\|^2)(1 - \|\mathbf{v}\|^2)} \right)
        $$

2.  **로렌츠 모델 (Lorentz Model) / 쌍곡면 모델**:
    -   **개념**: 아인슈타인의 특수 상대성 이론에서 사용하는 민코프스키 시공간과 유사한 $n+1$차원 공간에서, 위쪽으로 오목한 쌍곡면($-x_0^2 + \sum_{i=1}^n x_i^2 = -1$)으로 쌍곡 공간을 정의한다.
    -   **특징**: 푸앵카레 모델보다 직관성은 떨어지지만, 두 점 사이의 거리가 $\langle \mathbf{x}, \mathbf{y} \rangle_{\mathcal{L}}$ 내적으로 간단하게 표현되고 측지선 계산이 선형적이어서 수치적으로 안정적이고 계산에 유리하다.

### 2.3 뫼비우스 연산: 휘어진 공간의 산술

유클리드 공간의 벡터 연산(덧셈, 스칼라 곱)은 휘어진 쌍곡 공간에서 더 이상 유효하지 않다. 이를 대체하기 위해 뫼비우스 연산이 도입되었다(곡률 $c=1$ 가정).

-   **뫼비우스 덧셈**: $\mathbf{u} \oplus \mathbf{v}$는 단순히 두 벡터를 더하는 것이 아니라, **점 $\mathbf{u}$를 점 $\mathbf{v}$의 방향과 크기만큼 '평행 이동'**시키는 개념이다. 이 연산은 공간의 휘어짐을 고려하여, 이동 후에도 결과값이 원반 안에 머무르도록 보장한다. 아래의 복잡한 수식은 이러한 기하학적 변환을 대수적으로 표현한 것이다.
$$
\mathbf{u} \oplus \mathbf{v} = \frac{(1 + 2\langle\mathbf{u}, \mathbf{v}\rangle + \|\mathbf{v}\|^2)\mathbf{u} + (1 - \|\mathbf{u}\|^2)\mathbf{v}}{1 + 2\langle\mathbf{u}, \mathbf{v}\rangle + \|\mathbf{u}\|^2\|\mathbf{v}\|^2}
$$

-   **지수/로그 사상**: 신경망에서 선형 변환은 평평한 유클리드 공간(접공간)에서만 가능하다. 따라서 다음과 같은 변환 과정이 필수적이다.
    1.  **로그 사상 $\log_x(y)$**: 쌍곡 공간 위의 점 $y$를, 기준점 $x$가 인식하는 '평평한 지도'(접공간 $T_x\mathbb{B}^n$) 위의 벡터로 변환한다.
    2.  **선형 변환**: 평평한 접공간 위에서 일반적인 행렬 곱셈 등의 연산을 수행한다.
    3.  **지수 사상 $\exp_x(v)$**: 접공간에서 계산된 결과 벡터 $v$를 다시 휘어진 쌍곡 공간 위의 점으로 되돌려놓는다.

### 2.4 헬가손-푸리에 변환: 쌍곡 공간의 주파수 분석

헬가손-푸리에 변환(HFT)은 유클리드 공간의 푸리에 변환(소리를 주파수 성분으로 분해하는 것)을 쌍곡 공간으로 일반화한 것이다.

-   **핵심 아이디어**: 일반적인 푸리에 변환이 평면파 $e^{i\omega x}$를 기저로 사용하듯, HFT는 **쌍곡 공간의 기하학을 반영하는 특수한 파동(호로사이클, horocycle) $e^{(-i\lambda+\rho)B(x,b)}$**을 기저로 사용한다.
-   **의미**: 이를 통해 쌍곡 공간 위에 정의된 함수(또는 데이터 분포)를 '주파수'와 '방향' 성분으로 분해할 수 있다. 이는 복잡한 행렬 곱셈을 FFT처럼 효율적인 연산으로 대체하려는 Hyper-Butterfly 레이어의 핵심적인 수학적 영감을 제공한다.

$$ \tilde{f}(\lambda, b) = \int_{\mathbb{H}^n} f(x) e^{(-i\lambda+\rho)B(x,b)} dx $$
-   $\lambda$: 주파수의 크기
-   $b$: 무한대 경계점 (주파수의 방향)
-   $B(x,b)$: 부제만 함수 (점에서 특정 방향까지의 거리)
-   $\rho$: 공간의 차원에 따른 상수

HFT는 쌍곡 공간의 라플라스-벨트라미 연산자의 고유함수인 평면파(호로사이클 파동)를 기저로 사용하여 함수를 분해한다. 이는 `Reality Stone`의 Hyper-Butterfly 레이어와 같은 스펙트럼 방법론의 수학적 토대를 이룬다. 
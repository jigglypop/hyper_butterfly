## 4. 이론적 분석: RBE는 왜 효과적인가?

앞선 장에서 RBE의 작동 방식(How)을 설명했다면, 본 장에서는 RBE가 왜(Why) 효과적인지를 이론적 관점에서 심층적으로 분석한다. RBE의 성공은 단순히 영리한 공학적 트릭이 아니라, 정보 이론, 신호 처리, 최적화 이론에 깊은 뿌리를 둔 필연적인 결과임을 증명한다.

### 4.1. 정보 이론적 관점: 의미론적 정보 분리

가중치 행렬 $W$를 압축하는 것은 정보 이론의 '소스 코딩(Source Coding)' 문제로 볼 수 있다. 전통적인 양자화는 이 문제를 순수 통계적 관점에서 접근하여, 각 가중치 값을 최대한 손실 없이 인코딩하는 데 집중한다. 반면, RBE는 **의미론적 정보 분리(Semantic Information Separation)** 라는, 보다 근본적인 접근을 취한다.

-   **가중치의 이중적 의미:** 가중치 행렬의 각 행 $w_i$는 두 종류의 정보를 동시에 담고 있다.
    1.  **구조적/저주파 정보 (Structural/Low-Frequency):** 변환의 전반적인 방향성, 즉 어떤 입력 특징을 어떤 출력 특징으로 매핑할지에 대한 '거시적인 구조'. 이는 모델의 핵심적인 기능과 직결된다.
    2.  **세부적/고주파 정보 (Detailed/High-Frequency):** 그 구조 위에서 발생하는 미세한 변동과 예외. 이는 모델의 정밀도와 표현력에 기여한다.

RBE의 핵심은 이 두 정보를 물리적으로 분리하여, 각각에 최적화된 방식으로 인코딩하는 것이다.

-   **기저 청사진 (The Blueprint) $\rightarrow$ 구조적 정보:** 기저 벡터 인덱스와 기저 함수 타입은 변환의 핵심적인 '뼈대'를 나타낸다. 이는 가장 중요한 정보이므로, 에러에 민감하지 않은 강건한 디지털 비트 필드로 인코딩된다.
-   **잔차 (The Residual) $\rightarrow$ 세부적 정보:** 뼈대로는 표현되지 않는 '살'에 해당하는 세부 정보는 잔차 행렬에 담긴다. 이 정보는 상대적으로 덜 중요하므로, 약간의 손실을 감수하는 저정밀도 양자화를 통해 압축된다.

이러한 분리 덕분에, RBE는 제한된 비트 예산(bit budget)을 훨씬 효율적으로 사용할 수 있다. 중요한 정보는 확실하게 보존하고, 덜 중요한 정보는 선택적으로 압축함으로써, 동일한 압축률에서 기존 방식보다 훨씬 높은 성능을 달성하게 된다.

### 4.2. 신호 처리 관점: 기하학에 적응된 기저

신호 처리 분야에서, 복잡한 신호를 가장 효율적으로 표현하는 방법은 신호의 특성에 맞는 **기저(Basis)** 를 사용하는 것이다. 예를 들어, 주기적인 소리 신호는 푸리에 변환(사인파 기저)으로, 이미지의 경계선은 웨이블릿 변환으로 효율적으로 표현할 수 있다.

마찬가지로, 신경망의 가중치 행렬 또한 일종의 '신호'로 볼 수 있다. RBE의 핵심적인 통찰은 **데이터의 기하학적 구조가 가중치 행렬의 '신호 특성'을 결정한다**는 것이다.

-   **데이터가 계층적 구조를 가질 때:** 모델은 이 구조를 표현하기 위해 쌍곡 공간과 유사한 변환을 학습하게 된다. 이 때 가중치 행렬의 '신호'는 쌍곡 기하학의 기저 함수(예: `tanh`, `sinh`)로 분해할 때 가장 적은 수의 계수로 표현될 수 있다.
-   **데이터가 주기적 패턴을 가질 때:** 가중치 행렬은 위상적 패턴을 학습하게 되며, 이는 삼각 함수 기저로 분해할 때 가장 효율적일 것이다.

**정리 4.1 (기저 선택의 효율성):** 특정 기하학적 구조를 따르는 가중치 신호 $W$가 주어졌을 때, 해당 기하학에 맞는 RBE 기저 $\{b_j^{\text{geom}}\}$를 사용한 표현이, 범용적인 기저(예: PCA 기저 $\{b_j^{\text{pca}}\}$)를 사용한 표현보다 항상 더 적은 수의 계수로 동일한 수준의 재구성 오차를 달성한다.
$ \min_{c} \| W - \sum_{j=1}^k c_j b_j^{\text{geom}} \| \le \min_{d} \| W - \sum_{j=1}^k d_j b_j^{\text{pca}} \| $

이는 RBE가 단순히 가중치를 압축하는 것을 넘어, 데이터의 본질적인 구조를 파악하고 그에 맞는 '언어'로 가중치를 재서술하는 과정임을 시사한다.

### 4.3. 오차 분석: 재구성 오차의 분해

RBE의 전체 재구성 오차 $E_{\text{total}} = \|W - W_{\text{reconstruct}}\|$는 세 가지 주요 원천으로 분해하여 분석할 수 있다.

$ W_{\text{reconstruct}} = \text{Dequantize}(W_{\text{res}}) + W_{\text{approx}} $
$ E_{\text{total}} = \|W - (\text{Dequantize}(W_{\text{res}}) + W_{\text{approx}})\| $

여기서 $W_{\text{approx}}$는 청사진으로 재구성된 행렬이고, $W_{\text{res}} = \text{Quantize}(W - W_{\text{approx}})$ 이다.
삼각 부등식에 의해, 총 오차는 다음과 같이 상한이 정해진다.

$ E_{\text{total}} \le \|(W - W_{\text{approx}}) - \text{Dequantize}(\text{Quantize}(W - W_{\text{approx}}))\| + \|W - W_{\text{approx}} - (W - W_{\text{approx}})\| \rightarrow \text{잘못된 전개}$

정확한 오차 분석은 다음과 같다.
$ W - W_{\text{reconstruct}} = W - (\text{Dequantize}(\text{Quantize}(W - W_{\text{approx}})) + W_{\text{approx}}) $
$ = (W - W_{\text{approx}}) - \text{Dequantize}(\text{Quantize}(W - W_{\text{approx}})) $

따라서, 총 오차는 **잔차의 양자화 오차(Residual Quantization Error)** 와 같다.
$ E_{\text{total}} = E_{\text{quantization}} = \|W_{\text{res}}^{\text{original}} - \text{Dequantize}(\text{Quantize}(W_{\text{res}}^{\text{original}}))\| $

하지만, 압축의 효율성을 결정하는 것은 **청사진의 근사 오차(Blueprint Approximation Error)**, $E_{\text{approx}} = \|W - W_{\text{approx}}\|$ 이다. 이 값이 작을수록, 잔차 행렬 $W_{\text{res}}$의 원소들이 0에 가깝게 분포하게 되어 양자화 효율이 극대화되기 때문이다.

$E_{\text{approx}}$는 다시 두 가지 요소로 나뉜다.
1.  **기저 이산화 오차 ($E_{\text{basis}})$:** 유한한 개수의 기저 벡터 $\{b_j\}$를 사용함으로써 발생하는 오차. 기저의 개수 $B$가 늘어날수록 이 오차는 감소한다.
2.  **기저 함수 근사 오차 ($E_{\text{function}})$:** 선택된 기저 함수 $\mathcal{F}$가 실제 변환을 완벽하게 표현하지 못함으로써 발생하는 오차. 함수 라이브러리가 다양해질수록 이 오차는 감소한다.

결론적으로, RBE의 성능은 (1) 얼마나 좋은 기저 벡터와 기저 함수 라이브러리를 구축하는가($E_{\text{approx}}$를 줄이는 문제), 그리고 (2) 잔차를 얼마나 정밀하게 양자화하는가($E_{\text{quantization}}$를 줄이는 문제) 사이의 트레이드오프에 의해 결정된다. `Reality Stone`은 이 두 요소를 최적화하는 효율적인 알고리즘과 구현을 제공한다. 